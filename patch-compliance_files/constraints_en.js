(function(){window.goog=window.goog||{provide:function(){},require:function(){}};_.mixin(_.string.exports());window.amzn=window.amzn||{};window.amzn.cfn=window.amzn.cfn||{};window.amzn.cfn.constraints=window.amzn.cfn.constraints||{};var h=_.isFunction(Object.create)?_.bind(Object.create,Object):function(a){function f(){}f.prototype=a;return new f};window.amzn.cfn.constraints.utils=window.amzn.cfn.constraints.utils||{};window.amzn.cfn.constraints.utils.subclass=function(a,f){a.prototype=h(f.prototype);
a.prototype.constructor=a};var g=/^List<([^>]+)>$/;window.amzn.cfn.constraints.utils.extractBaseType=function(a){var f=g.exec(a);return f?f[1]:a};window.amzn.cfn.constraints.utils.isListType=function(a){return g.test(a)};window.amzn.cfn.constraints.utils.isAWSNamespaced=function(a){return _.startsWith(a,"AWS::")}})();(function(){function h(g,a,f){this.value=g;this.tags=_.clone(a||{});this.additionalInfo=_.clone(f||{})}amzn.cfn.constraints.external={};h.parse=function(g){return new h(g.value,g.tags,g.additionalInfo)};window.amzn.cfn.constraints.external=angular.module("amzn.cfn.constraints.external",["smServices"]);window.amzn.cfn.constraints.external.factory("ExternalService",["$q","HttpHelper","SERVICE_PATH",function(g,a,f){function d(d,c,m){function n(g){return a.httpFactory({method:"GET",url:"/"+f+"/service/externalValues",
params:_.extend(_.clone(c||{}),{type:d,nextToken:g,pageSize:m||null})})}function k(d){return g.reject(d)}function l(d,a){if(_.isUndefined(a)||_.isNull(a))return null;if(m)return a.values=_.map(a.values,h.parse),a;var e=d.concat(_.map(a.values,h.parse));return!a.nextToken?e:n(a.nextToken).then(_.partial(l,e),k)}return n().then(_.partial(l,[]),k)}return{getValues:d,getValuesForTemplate:function(a,c,f,h){var k=_.reduce(c||[],function(a,d){a[d.parameterKey]=d;return a},{});c=_.reject(_.map(c,function(a){a=
amzn.cfn.constraints.utils.extractBaseType(a.parameterType);return amzn.cfn.constraints.utils.isAWSNamespaced(a)?a:null}),_.isNull);a=_.uniq(a.getTypeDependencies(k).concat(c));a=_.reduce(a,function(a,c){a[c]=d(c,f,h);return a},{});return g.all(a).then(function(a){return a},g.reject)}}}]);window.amzn.cfn.constraints.external.ExternalValue=h})();(function(){function h(b){if(_.isString(b))return b;if(_.isArray(b))return _.map(b,h);if(_.isObject(b))return window.amzn.cfn.constraints.constraintFunctionParser(b);throw Error("Unsupported argument definition type: "+typeof b);}function g(b,a){if(!_.isArray(b)||2!==b.length||!_.isString(b[0])||!_.isString(b[1]))throw Error(a+" requires an array of exactly two strings.");}function a(b,a){this.type=b;this.fnArgs=a}function f(b,d){if(_.isString(b)||_.isBoolean(b)||_.isNumber(b))return b;if(b instanceof
a){if(!b.canCollapse(d))throw Error("Collapse called when function was not collapsible");return b.collapse(d)}if(_.isArray(b))return _.map(b,function(b){return f(b,d)});throw Error("Unsupported argument: "+b);}function d(b){a.call(this,"Pseudo::Constant",b)}function e(b){a.call(this,"Ref",b);if(!_.isString(this.fnArgs))throw Error("Ref requires a single string parameter.");this.pseudoParams={"AWS::AccountId":function(b){return b.accountId},"AWS::NotificationARNs":function(b){throw b.notificationArns;
},"AWS::Region":function(b){return b.region},"AWS::StackId":function(){throw Error("AWS::StackId is not supported in client constraints");},"AWS::StackName":function(b){return b.stackName}}}function c(b){a.call(this,"RefAll",b);if(!_.isString(this.fnArgs))throw Error("RefAll requires a single string parameter.");}function m(b){a.call(this,"Equals",b)}function n(b){a.call(this,"EachMemberEquals",b)}function k(b){a.call(this,"EachMemberIn",b)}function l(b){a.call(this,"Contains",b)}function y(b,a,d){function c(b){var e=
_.find(d,function(a){return a.value===b});return _.startsWith(a,"Tags.")?e.tags[a.substring(5)]||"":e.additionalInfo[a]}return _.isArray(b)?_.map(b,c):c(b)}function p(b){a.call(this,"ValueOf",b);g(b,this.type)}function q(b){a.call(this,"ValueOfAll",b);g(b,this.type);if(!amzn.cfn.constraints.utils.isAWSNamespaced(amzn.cfn.constraints.utils.extractBaseType(b[0])))throw Error("Illegal type for Fn::ValueOfAll: "+amzn.cfn.constraints.utils.extractBaseType(b[0]));}function s(b){return _.map(b,function(b){return _.isBoolean(b)?
b:_.isString(b)?"true"===b.toLocaleLowerCase():!1})}function t(b){a.call(this,"And",b)}function u(b){a.call(this,"Or",b)}function v(b){a.call(this,"Not",b)}function r(b){a.call(this,"Select",b)}function w(b){a.call(this,"Join",b)}amzn.cfn.constraints.functions={};a.prototype.collapse=function(){throw Error("Not implemented for "+this.type);};a.prototype.canCollapse=function(b){var a=_.filter(_.keys(b.parameters),function(a){return!!b.parameterValues[a]});return 0===_.difference(this.getParameterDependencies(b.parameters),
a).length};a.prototype.canUseInFilter=function(b){if(_.isString(this.fnArgs))return!0;if(this.fnArgs instanceof a)return this.fnArgs.canUseInFilter(b);if(_.isArray(this.fnArgs)){var d=function(c){if(_.isString(c))return!0;if(c instanceof a)return c.canUseInFilter(b);if(_.isArray(c))return _.map(c,d)};return _.every(_.flatten(_.map(this.fnArgs,d),_.partial(_.isEqual,!0)))}};a.prototype.getParameterDependencies=function(b){if(_.isString(this.fnArgs))return[];if(this.fnArgs instanceof a)return this.fnArgs.getParameterDependencies(b);
if(_.isArray(this.fnArgs)){var d=function(c){if(_.isString(c))return null;if(c instanceof a)return c.getParameterDependencies(b);if(_.isArray(c))return _.map(c,d)};return _.reject(_.uniq(_.flatten(_.map(this.fnArgs,d))),_.isNull)}};a.prototype.generateTypeDependencies=function(b){if(_.isString(this.fnArgs))return[];if(this.fnArgs instanceof a)return this.fnArgs.generateTypeDependencies(b);if(_.isArray(this.fnArgs)){var d=function(c){if(_.isString(c))return null;if(c instanceof a)return c.generateTypeDependencies(b);
if(_.isArray(c))return _.map(c,d)};return _.reject(_.uniq(_.flatten(_.map(this.fnArgs,d))),_.isNull)}};a.prototype.localize=function(b){var d=this.type+"_fn";if(_.isString(this.fnArgs))return b(d,{arg:this.fnArgs});if(this.fnArgs instanceof a)return b(d,{arg:this.fnArgs.localize(b)});if(_.isArray(this.fnArgs)){var c=function(d){if(_.isString(d))return d;if(d instanceof a)return d.localize(b);if(_.isArray(d))return _.map(d,c)};return b(d,{arg:_.map(this.fnArgs,c)})}};window.amzn.cfn.constraints.utils.subclass(d,
a);d.prototype.collapse=function(){return this.fnArgs};d.prototype.canCollapse=function(){return!0};d.prototype.generateTypeDependencies=function(){return[]};window.amzn.cfn.constraints.utils.subclass(e,a);e.prototype.collapse=function(b){if(amzn.cfn.constraints.utils.isAWSNamespaced(this.fnArgs)){if(_.has(this.pseudoParams,this.fnArgs))return this.pseudoParams[this.fnArgs](b);throw Error("Invalid pseudo-parameter "+this.fnArgs);}var a=b.parameterValues[this.fnArgs];return"CommaDelimitedList"===b.parameters[this.fnArgs].parameterType||
_.isString(a)&&"List<String>"===b.parameters[this.fnArgs].parameterType?a.split(","):a};e.prototype.getParameterDependencies=function(){return amzn.cfn.constraints.utils.isAWSNamespaced(this.fnArgs)?[]:[this.fnArgs]};window.amzn.cfn.constraints.utils.subclass(c,a);c.prototype.collapse=function(b){var a=this.fnArgs,d=_.filter(_.values(b.parameters),function(b){return amzn.cfn.constraints.utils.extractBaseType(b.parameterType)===a});return _.flatten(_.map(d,function(a){return b.parameterValues[a.parameterKey]}),
!0)};c.prototype.generateTypeDependencies=function(){return[]};c.prototype.getParameterDependencies=function(b){var a=this.fnArgs;b=_.filter(_.values(b),function(b){return amzn.cfn.constraints.utils.extractBaseType(b.parameterType)===a});return _.pluck(b,"parameterKey")};window.amzn.cfn.constraints.utils.subclass(m,a);m.prototype.collapse=function(b){b=f(this.fnArgs,b);g(b,this.type);return b[0]===b[1]};window.amzn.cfn.constraints.utils.subclass(n,a);n.prototype.collapse=function(b){b=f(this.fnArgs,
b);if(!_.isArray(b)||2!==b.length||!_.isArray(b[0])||!_.every(b[0],_.isString)||!_.isString(b[1]))throw Error(this.type+" requires two non-empty parameters: a list of strings and a string");return _.every(b[0],_.partial(_.isEqual,b[1]))};window.amzn.cfn.constraints.utils.subclass(k,a);k.prototype.collapse=function(b){var a=f(this.fnArgs,b);if(!_.isArray(a)||2!==a.length||!_.isArray(a[0])||!_.every(a[0],_.isString)||!_.isArray(a[1])||!_.every(a[1],_.isString))throw Error(this.type+" requires an array of two arrays of strings.");
return _.every(a[0],_.memoize(function(b){return-1!==_.indexOf(a[1],b)}))};window.amzn.cfn.constraints.utils.subclass(l,a);l.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||2!==b.length||!_.isArray(b[0])||!_.every(b[0],_.isString)||!_.isString(b[1]))throw Error("Fn::Contains requires two non-empty parameters: a list of strings and a string");return _.contains(b[0],b[1])};l.prototype.canUseInFilter=function(){return _.isArray(this.fnArgs)&&_.isArray(this.fnArgs[0])&&_.every(this.fnArgs[0],
_.isString)};window.amzn.cfn.constraints.utils.subclass(p,a);p.prototype.collapse=function(b){var a=this.fnArgs[0],d=b.parameters[a];if(!amzn.cfn.constraints.utils.isAWSNamespaced(amzn.cfn.constraints.utils.extractBaseType(d.parameterType)))throw Error("Illegal type for Fn::ValueOf: "+d.parameterType);return y(b.parameterValues[a],this.fnArgs[1],b.externalValues[amzn.cfn.constraints.utils.extractBaseType(d.parameterType)])};p.prototype.generateTypeDependencies=function(b){b=amzn.cfn.constraints.utils.extractBaseType(b[this.fnArgs[0]].parameterType);
if(!amzn.cfn.constraints.utils.isAWSNamespaced(b))throw Error("Illegal type for Fn::ValueOf: "+b);return[b]};p.prototype.getParameterDependencies=function(){return[this.fnArgs[0]]};window.amzn.cfn.constraints.utils.subclass(q,a);q.prototype.collapse=function(b){var a=this.fnArgs[0],d=this.fnArgs[1],c=_.filter(_.values(b.parameters),function(b){return amzn.cfn.constraints.utils.extractBaseType(b.parameterType)===a});return _.flatten(_.map(c,function(c){return y(b.parameterValues[c.parameterKey],d,
b.externalValues[a])}),!0)};q.prototype.generateTypeDependencies=function(){return[amzn.cfn.constraints.utils.extractBaseType(this.fnArgs[0])]};q.prototype.getParameterDependencies=function(b){var a=this.fnArgs[0];b=_.filter(_.values(b),function(b){return amzn.cfn.constraints.utils.extractBaseType(b.parameterType)===a});return _.pluck(b,"parameterKey")};window.amzn.cfn.constraints.utils.subclass(t,a);t.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||2>b.length)throw Error("Fn::And requires an array of at least two boolean values.");
return _.every(s(b),_.partial(_.isEqual,!0))};window.amzn.cfn.constraints.utils.subclass(u,a);u.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||2>b.length)throw Error("Fn::Or requires an array of two to ten boolean values.");return _.any(s(b),_.partial(_.isEqual,!0))};window.amzn.cfn.constraints.utils.subclass(v,a);v.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||1!==b.length)throw Error("Fn::Not requires an array of one boolean value.");return!s(b)[0]};window.amzn.cfn.constraints.utils.subclass(r,
a);r.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||2!==b.length)throw Error("Fn::Select requires a list consisting of an index and a list of objects.");if(!_.isArray(b[1]))throw Error("Fn::Select's second argument must be an array.");var a=_.isNumber(b[0])?b[0]:parseInt(b[0],10);if(!_.isNumber(a)||0>a||a>=b[1].length)throw Error("Fn::Select's first argument must be a positive integer between 0 and the length of the input array (exclusive).");return b[1][a]};r.prototype.canUseInFilter=
function(){return!1};window.amzn.cfn.constraints.utils.subclass(w,a);w.prototype.collapse=function(b){b=f(this.fnArgs,b);if(!_.isArray(b)||2!==b.length||!_.isString(b[0])||!_.isArray(b[1]))throw Error("Fn::Join requires an array consisting of a separator and an array of strings");return b[1].join(b[0])};var x={Ref:e,EachMemberEquals:n,EachMemberIn:k,Equals:m,Contains:l,ValueOf:p,ValueOfAll:q,RefAll:c,And:t,Or:u,Not:v,Select:r,Join:w};window.amzn.cfn.constraints.constraintFunctionParser=function(b){if(1!==
_.keys(b).length)throw Error("Functions can only have one key");var a=_.keys(b)[0],d=_.startsWith(a,"Fn::")?a.substring(4):a;b=h(b[a]);if(!_.has(x,d))throw Error("Unsupported Function: "+a);return new x[d](b)};window.amzn.cfn.constraints.ConstantConstraintFunction=d;window.amzn.cfn.constraints.functions=x;window.amzn.cfn.constraints.EvaluationContext=function(b,a,d,c,e,f,g){this.parameters=_.reduce(b||[],function(b,a){b[a.parameterKey]=a;return b},{});this.parameterValues=_.clone(a||{});this.stackName=
d;this.region=c;this.accountId=e;this.notificationArns=(f||[]).slice();this.externalValues=_.clone(g||{})}})();(function(){function h(){this.failMap={};this.globalFailureMessages=[]}function g(a,e){this.constraintFunction=a;this.description=e}function a(a,e){this.condition=a;this.assertions=e}function f(a){this.rules=_.clone(a)}amzn.cfn.constraints.document={};h.prototype.add=function(a,e){var c=this.failMap;_.isNull(a)||_.isEmpty(a)?this.globalFailureMessages.push(e):_.each(a,function(a){_.has(c,a)?c[a].push(e):c[a]=[e]})};h.prototype.hasFailures=function(){return!_.isEmpty(this.failMap)||!_.isEmpty(this.globalFailureMessages)};
h.prototype.getFailedParams=function(){return _.keys(this.failMap)};h.prototype.getFailureMessages=function(a){return!a?_.clone(this.globalFailureMessages):_.clone(this.failMap[a]||[])};h.prototype.merge=function(a){this.globalFailureMessages=this.globalFailureMessages.concat(a.globalFailureMessages);var e=this;_.each(a.getFailedParams(),function(c){_.has(e.failMap,c)?e.failMap[c]=e.failMap[c].concat(a.getFailureMessages(c)):e.failMap[c]=a.getFailureMessages(c)})};g.parse=function(a,e){if(!_.has(e,
"Assert"))throw Error('Assertions must have an "Assert" key');var c=amzn.cfn.constraints.constraintFunctionParser(e.Assert),f=e.AssertDescription||c.localize(a);return new g(c,f)};g.prototype.canCollapse=function(a){return this.constraintFunction.canCollapse(a)};g.prototype.collapse=function(a){if(!this.canCollapse(a))throw Error("collapse() called on non-collapsible Assertion.");return this.constraintFunction.collapse(a)};g.prototype.filterSelection=function(a,e){if(!this.canCollapse(e))throw Error("filterSelection() called on non-collapsible Assertion.");
var c=_.contains(this.constraintFunction.getParameterDependencies(e.parameters),a),f=this.constraintFunction.collapse(e);return!c?!0:!this.constraintFunction.canUseInFilter(e)||f};g.prototype.getConstrainedParameters=function(a){return this.constraintFunction.getParameterDependencies(a)};g.prototype.getTypeDependencies=function(a){return this.constraintFunction.generateTypeDependencies(a)};a.parse=function(d,e){var c=_.has(d,"RuleCondition")?amzn.cfn.constraints.constraintFunctionParser(d.RuleCondition):
new amzn.cfn.constraints.ConstantConstraintFunction(!0);if(!_.isArray(d.Assertions))throw Error("Assertions must be a list of Assertion objects.");var f=_.map(d.Assertions,_.partial(g.parse,e));return new a(c,f)};a.prototype.canCollapseCondition=function(a){return this.condition.canCollapse(a)};a.prototype.isActive=function(a){return this.canCollapseCondition(a)&&!0===this.condition.collapse(a)};a.prototype.collapse=function(a){if(!this.isActive(a))throw Error("Cannot collapse inactive Rule");var e=
new h;_.each(this.assertions,function(c){c.canCollapse(a)&&!0!==c.collapse(a)&&e.add(c.getConstrainedParameters(a.parameters),c.description)});return e};a.prototype.filterSelection=function(a,e){if(!this.isActive(e))throw Error("Cannot filter inactive Rule");return _.every(this.assertions,function(c){return!c.canCollapse(e)||c.filterSelection(a,e)})};a.prototype.getTypeDependencies=function(a){var e=_.map(this.assertions,function(c){return c.getTypeDependencies(a)});return _.uniq(_.flatten(this.condition.generateTypeDependencies(a).concat(e)))};
f.parse=function(d,e){if(!d)return new window.amzn.cfn.constraints.ConstraintDocument({});if(!_.isString(d))throw Error("Constraint Document input must be of type string");var c=angular.fromJson(d);if(!_.isObject(c))throw Error("Constraint Document must be a well-formed JSON object.");return new window.amzn.cfn.constraints.ConstraintDocument(_.reduce(c,function(c,d,f){c[f]=a.parse(d,e);return c},{}))};f.prototype.getTypeDependencies=function(a){return _.uniq(_.flatten(_.map(this.rules,function(e){return e.getTypeDependencies(a)})))};
f.prototype.collapse=function(a){var e=_.map(this.rules,function(c){return c.isActive(a)?c.collapse(a):new h});return _.reduce(e,function(a,d){a.merge(d);return a},new h)};f.prototype.filterSelection=function(a,e){var c=[];e.parameters[a].parameterConstraints&&(c=e.parameters[a].parameterConstraints.allowedValues||[]);var f=e.parameterValues[a];return!_.isEmpty(c)&&-1===_.indexOf(c,_.isArray(f)&&!_.isEmpty(f)?f[0]:f)?!1:_.every(this.rules,function(c){return!c.isActive(e)||c.filterSelection(a,e)})};
window.amzn.cfn.constraints.ConstraintDocument=f;window.amzn.cfn.constraints.Rule=a;window.amzn.cfn.constraints.Assertion=g;window.amzn.cfn.constraints.AssertionFailures=h})();(function(){amzn.cfn.constraints.localized={};amzn.cfn.constraints.localized={}})();(function(){amzn.cfn.constraints.templates={};angular.module("constraintTemplates",[]).run(["$templateCache",function(h){}])})();
